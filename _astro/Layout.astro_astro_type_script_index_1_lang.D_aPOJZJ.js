import{B as y,b as l,c as E}from"./constants.BrDZxk0X.js";import{s as w}from"./siteConfig.D4VXPo8I.js";import"./navBarConfig.D8PtX1HU.js";import{p as v,u as L}from"./url-utils.BJNipj_S.js";import"./zh_TW.CvKxZ37Z.js";const m=!!document.getElementById("banner-wrapper");function p(t,n){document.addEventListener("click",e=>{let o=document.getElementById(t),i=e.target;if(i instanceof Node){for(let s of n){let a=document.getElementById(s);if(a==i||a?.contains(i))return}o.classList.add("float-panel-closed")}})}p("display-setting",["display-setting","display-settings-switch"]);p("nav-menu-panel",["nav-menu-panel","nav-menu-switch"]);p("search-panel",["search-panel","search-bar","search-switch"]);function u(){document.querySelectorAll(".katex-display:not([data-scrollbar-initialized])").forEach(n=>{if(!n.parentNode)return;const e=document.createElement("div");e.className="katex-display-container",n.parentNode.insertBefore(e,n),e.appendChild(n),e.style.cssText=`
			overflow-x: auto;
		`,n.setAttribute("data-scrollbar-initialized","true")})}function g(){const t=w.backgroundWallpaper.mode==="banner";!w.backgroundWallpaper.enable||!t||requestAnimationFrame(()=>{const n=document.getElementById("banner");n&&n.classList.remove("opacity-0","scale-105");const e=document.querySelector('.block.lg\\:hidden[alt="Mobile banner image of the blog"]');e&&(e.classList.remove("opacity-0","scale-105"),e.classList.add("opacity-100"))})}const b=()=>{window.swup.hooks.on("link:click",()=>{if(document.documentElement.style.setProperty("--content-delay","0ms"),m){const t=document.getElementById("navbar-wrapper");if(t&&document.body.classList.contains("lg:is-home")){const n=window.innerHeight*(l/100)-88;document.documentElement.scrollTop>=n&&t.classList.add("navbar-hidden")}}}),window.swup.hooks.on("content:replace",()=>{if(u(),document.getElementById("toc-wrapper")!==null){const o=document.querySelector("table-of-contents");o&&typeof o.init=="function"&&setTimeout(()=>{o.init()},100)}typeof window.mobileTOCInit=="function"&&setTimeout(()=>{window.mobileTOCInit()},100);const e=document.getElementById("navbar");e&&e.getAttribute("data-transparent-mode")==="semifull"&&typeof window.initSemifullScrollDetection=="function"&&window.initSemifullScrollDetection()}),window.swup.hooks.on("visit:start",t=>{const n=document.querySelector("body"),e=v(t.to.url,L("/"));e?n.classList.add("lg:is-home"):n.classList.remove("lg:is-home");const o=document.querySelector(".banner-text-overlay");o&&(e?o.classList.remove("hidden"):o.classList.add("hidden"));const i=document.getElementById("navbar");i&&(i.setAttribute("data-is-home",e.toString()),i.getAttribute("data-transparent-mode")==="semifull"&&typeof window.initSemifullScrollDetection=="function"&&window.initSemifullScrollDetection());const s=document.getElementById("banner-wrapper"),a=document.querySelector(".absolute.w-full.z-30");s&&a&&(e?(setTimeout(()=>{s.classList.remove("mobile-hide-banner")},100),setTimeout(()=>{a.classList.remove("mobile-main-no-banner")},150)):(s.classList.add("mobile-hide-banner"),setTimeout(()=>{a.classList.add("mobile-main-no-banner")},100)));const h=document.getElementById("page-height-extend");h&&h.classList.remove("hidden");let f=document.getElementById("toc-wrapper");f&&f.classList.add("toc-not-ready")}),window.swup.hooks.on("page:view",()=>{const t=document.getElementById("page-height-extend");t&&t.classList.remove("hidden"),window.scrollTo({top:0,behavior:"instant"});const o=(localStorage.getItem("theme")||"LIGHT_MODE")==="DARK_MODE"?"github-dark":"github-light";document.documentElement.getAttribute("data-theme")!==o&&(document.documentElement.setAttribute("data-theme",o),setTimeout(()=>{window.dispatchEvent(new CustomEvent("theme-change"))},50)),setTimeout(()=>{if(document.getElementById("tcomment")){const s=new CustomEvent("firefly:page:loaded",{detail:{path:window.location.pathname,timestamp:Date.now()}});document.dispatchEvent(s),console.log("Layout: 触发 firefly:page:loaded 事件，路径:",window.location.pathname)}},300)}),window.swup.hooks.on("visit:end",t=>{setTimeout(()=>{const n=document.getElementById("page-height-extend");n&&n.classList.add("hidden");const e=document.getElementById("toc-wrapper");e&&e.classList.remove("toc-not-ready")},200)})};window?.swup?.hooks?b():document.addEventListener("swup:enable",b);let c=document.getElementById("back-to-top-btn"),d=document.getElementById("toc-wrapper"),r=document.getElementById("navbar-wrapper");function T(t,n){let e;return function(){const o=arguments,i=this;e||(t.apply(i,o),e=!0,setTimeout(()=>e=!1,n))}}function B(){const t=document.documentElement.scrollTop,n=window.innerHeight*(l/100);requestAnimationFrame(()=>{if(c&&(t>n?c.classList.remove("hide"):c.classList.add("hide")),m&&d&&(t>n?d.classList.remove("toc-hide"):d.classList.add("toc-hide")),m&&r){const o=document.body.classList.contains("lg:is-home")&&window.innerWidth>=1024?E:l,i=window.innerHeight*(o/100)-88;t>=i?r.classList.add("navbar-hidden"):r.classList.remove("navbar-hidden")}})}window.onscroll=T(B,16);window.onresize=()=>{let t=Math.floor(window.innerHeight*(y/100));t=t-t%4,document.documentElement.style.setProperty("--banner-height-extend",`${t}px`)};document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{g(),u()}):(g(),u());
